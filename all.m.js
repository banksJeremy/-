(function(){var a;a=$.openDB("data.db",{data:["time","subject"]}),jQuery(function(){var b,c,d;b=$("body"),b.append(d=$("<h1>").text("TraQk")),b.append(c=$("<div>")),b.css({margin:0,padding:0,background:"rgb(255, 252, 250)",fontFamily:"sans-serif",textAlign:"right"}),b.perlin({gridSpacing:1.413,color:[16,16,0],opacity:.1,tileable:!0}),d.css({background:"#222",borderBottom:".125em solid black",color:"white",padding:".125em .25em 0",margin:0,boxShadow:"0 0 .125em black",textAlign:"left",textIndent:".125em"}),$.makeBox=function(){var a;a=$("<div>"),a.css({textAlign:"left",display:"inline-block",height:"8em",width:"12em",background:"rgb(250, 255, 255)",fontSize:"1.5em",margin:".4em",border:".125em solid #111",padding:".4em",borderRadius:"1em",borderTopRightRadius:"0",boxShadow:".05em .05em .5em black",cursor:"pointer"}),a.hover(function(){return a.css({borderColor:"#FA2"})},function(){return a.css({borderColor:"#111"})}),a.click(function(){return a.hide("0.2")}),a.perlin({gridSpacing:2.1,opacity:.05,tileable:!0}),a.hide(),c.prepend(a),setTimeout(function(){return a.show("0.4")},0);return a},$.makeBox().html("Hello, World!");return a.then(function(a){$.makeBox().text("Database loaded."),a.data.put({time:10,subject:"me",x:10,y:0}).then(function(){return $.makeBox().text("Fake data put.")});return a.data.get().each(function(a){return $.makeBox().text(JSON.stringfy(a))})})})}).call(this),function(){var a,b,c,d,e,f=Object.prototype.hasOwnProperty,g=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1};a=function(a,b){var c,d;a==null&&(a="0123456789ABCDEF"),b==null&&(b=128),c=Math.ceil(a*Math.log(a.length)/Math.log(2));return function(){var b;b=[];for(d=0;0<=c?d<c:d>c;0<=c?d++:d--)b.push(a[Math.random()*a.length|0]);return b}().join("")},console.log(a()),jQuery.IndexedDB=function(){function a(a,b){var c;for(c in b){if(!f.call(b,c))continue;this[c]=new jQuery.IDBObjectStore(a,c)}}return a}(),jQuery.IDBObjectStore=function(){function a(a,b){this.db=a,this.name=b}a.prototype.get=function(a){return new jQuery.IDBResult};return a}(),jQuery.IDBResult=function(){function a(){}a.prototype.next=function(){var a;a=new jQuery.Deferred;return a},a.prototype.each=function(a){return!0};return a}(),jQuery.openDB=function(a,b,c){var d,e;c==null&&(c=!1),d=new jQuery.Deferred,e=indexedDB.open(a),e.onsuccess=function(h){var i,j,k,l,m,n,o,p,q,r,s;i=e.result;if($.isArray(b)){o={};for(r=0,s=b.length;r<s;r++)l=b[r],o[l]=[];b=o}n=[];for(l in b){if(!f.call(b,l))continue;p=b[l],p.sort(),n.push(l)}n.sort(),m="{"+function(){var c;c=[];for(l in b){if(!f.call(b,l))continue;k=b[l],c.push(""+JSON.stringify(a)+":"+JSON.stringify(k))}return c}().join(",")+"}",j=new $.IndexedDB(i,b);if(c||i.version!==m)q=i.setVersion(m),q.onsuccess=function(a){var d,h,k,l,m,n,o;console.log("TODO: Initialize stuff.                Each objectStore has an auto-incrementing ._id.");if(c)for(l=0,n=objectStoreNames.length;l<n;l++)k=objectStoreNames[l],i.deleteObjectStore(k);for(k in b){if(!f.call(b,k))continue;h=b[k],g.call(i.objectStoreNames,k)<0&&i.createObjectStore(k,{keyPath:"_id",autoIncrement:!0});for(m=0,o=h.length;m<o;m++)d=h[m],i.createIndex(k,d,{unique:!1})}return setTimeout(function(){return e.resolve(j)},0)},q.onerror=function(a){return d.reject("Error versioning database.",a)};return setTimeout(function(){return d.resolve(j)},0)},e.onerror=function(a){return d.reject("Error opening database.",a)};return d.promise()},window.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.mIndexedDB||function(){throw new Error("Fatal Error: IndexedDB is unavailable.")}();for(c in window)(b=/^[a-z]+(IDB.*)$/.exec(c))&&(e=window[d=b[1]])==null&&(window[d]=window[c])}.call(this)