(function(){var a,b,c,d=Array.prototype.slice;if(typeof log=="undefined"||log===null)log=function(){var a,b;b=a,a=1<=b.length?d.call(b,0):[];return typeof console!="undefined"&&console!==null?typeof console.log=="function"?console.log.apply(console,a):void 0:void 0};c=function(c){var d,e,f;d=$("body"),d.css({font:"14pt Helvetica"}),e=$("<h1>").html("<span>Tra<span>Q</span>k</span>"),d.append(e),log("Putting filler values into database."),f=[],f.push({foo:"Bar"},{time:99,age:20,subject:2}),f.push({time:13},{subject:"CN Tower"}),a(c,"data",f,function(){return log("Filler values added.")}),log("Displaying all values");return b(c,"data",function(a){log("Got all values."),d.append($("<h2>").text("Current Data"));return d.append($("<pre>").text(JSON.stringify(a)))})},a=function(a,b,c,d){var e,f,g,h,i;f=a.transaction([b],IDBTransaction.READ_WRITE),e=f.objectStore(b);for(h=0,i=c.length;h<i;h++)g=c[h],e.add(g);f.onsuccess=d;return f.onerror=function(a){throw JSON.stringify(a)}},b=function(a,b,c){var d,e,f;f=a.transaction([b]),e=f.objectStore(b),d=[];return e.openCursor().onsuccess=function(){var a;a=event.target.result;return a?d.push(a.value):c(d)}},withDB(c,"data.db","0.1",function(a){var b;try{a.deleteObjectStore("data")}catch(c){}b=a.createObjectStore("data",{keyPath:"id",autoIncrement:!0}),b.createIndex("time","time");return b.createIndex("subject","subject")})}).call(this),function(){var a,b,c=Object.prototype.hasOwnProperty,d=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1};jQuery.IndexedDB=function(){function a(a,b){var d;for(d in b){if(!c.call(b,d))continue;this[d]=new jQuery.IDBObjectStore(a,d)}}return a}(),jQuery.IDBObjectStore=function(){function a(a,b){this.db=a,this.name=b}a.prototype.get=function(a){return new jQuery.IDBResult};return a}(),jQuery.IDBResult=function(){function a(){}a.prototype.next=function(){var a;a=new jQuery.Deferred;return a},a.prototype.each=function(a){return!0};return a}(),jQuery.openDB=function(a,b,e){var f,g;e==null&&(e=!1),f=new jQuery.Deferred,g=indexedDB.open(a),g.onsuccess=function(h){var i,j,k,l,m,n,o,p,q,r,s;i=g.result;if($.isArray(b)){o={};for(r=0,s=b.length;r<s;r++)l=b[r],o[l]=[];b=o}n=[];for(l in b){if(!c.call(b,l))continue;p=b[l],p.sort(),n.push(l)}n.sort(),m="{"+function(){var d;d=[];for(l in b){if(!c.call(b,l))continue;k=b[l],d.push(""+JSON.stringify(a)+":"+JSON.stringify(k))}return d}().join(",")+"}",j=new $.IndexedDB(i,b);if(e||i.version!==m)q=i.setVersion(m),q.onsuccess=function(a){var f,h,k,l,m,n,o;console.log("TODO: Initialize stuff.                Each objectStore has an auto-incrementing ._id.");if(e)for(l=0,n=objectStoreNames.length;l<n;l++)k=objectStoreNames[l],i.deleteObjectStore(k);for(k in b){if(!c.call(b,k))continue;h=b[k],d.call(i.objectStoreNames,k)<0&&i.createObjectStore(k,{keyPath:"_id",autoIncrement:!0});for(m=0,o=h.length;m<o;m++)f=h[m],i.createIndex(k,f,{unique:!1})}return setTimeout(function(){return g.resolve(j)},0)},q.onerror=function(a){return f.reject("Error versioning database.",a)};return setTimeout(function(){return g.resolve(j)},0)},g.onerror=function(a){return f.reject("Error opening database.",a)};return f.promise()},window.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.mIndexedDB||function(){throw new Error("Fatal Error: IndexedDB is unavailable.")}();for(b in window)if(a=/^[a-z]+(IDB.*)$/.exec(b))window[a[1]]=window[b]}.call(this)